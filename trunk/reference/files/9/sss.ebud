;ÓOURCE CODE FOR THE ROUTINE THAT ;ROTATES THE COLORS ON THE TITLE SCREEN;USED IN THE FILE "SEQ-SORT" BY ;Ò.×. (ÂOB K7) ËOBER: Ñ-ÌÉÎË'S ÓÙÓÏÐ ÂË;ÍAY 13, 1989;;.ORG $8000 ;CALLED WITH A SYS32768.DIS ;.DIS P;.MEM;.OBJ "SSS";; *** ÅQUATES ***;SCN = $D829PTR = $FBSPEED = 820ROWS = 821DELAY = $EEB3GETIN = $FFE4;; *** ÓET ZERO PAGE POINTERS ***;LDA <SCNLDY >SCNSTA PTRSTY PTR+1;; *** ÇET COLORS IN ORDER, 1 TO 15;     ÂLACK (0) NOT ALLOWED ***;LDY #0- LDA #0TAX- INXTXAAND #15BEQ --;;*** ÓTORE COLORS IN TOP HALF OF;    SCREEN MEMORY ***;STA (PTR),YINC PTR+1STA (PTR),YDEC PTR+1INYBNE -;; *** ÓAVE POINTERS FOR FUTURE USE ***;LDA PTR+1PHALDA PTRPHA;; *** ÓET UP TO COLOR TEXT AREA ***;LDA <SCNLDY >SCNSTA PTRSTY PTR+1CLCADC #41STA PTRBCC +INC PTR+1;; *** ÇET COLORS 1-15 AGAIN    ;     ÂALCK (0) STILL NOT ALLOWED ***;+ LDY #0- LDA #0TAX- INXTXAAND #15BEQ --;; *** ÓET NUMBER OF ROWS TO COLOR ***;PHA:TXALDX ROWSDEX:DEXSTX VERT+1TAX:PLA;; *** ÃOLOR FIRST 2 POSITIONS IN THE;     FIRST ROW ***;- STA (PTR),YINYSTA (PTR),YDEYDEC VERT+1BMI +;; *** ÎOW DO THE FIRST 2 COLUMNS IN;     THE REST OF THE ROWS ***;JSR DOWN40BNE -;; *** ÒESET ROW COUNTER ***;+ TXALDX ROWSDEX:DEXSTX VERT+1TAX;; *** ÍOVE POINTER BACK TO THE TOP ***;- JSR UP40DEC VERT+1BNE -;; *** ÍOVE OVER AND DO THE NEXT 2;     COLUMNS WITH ANOTHER COLOR ***;INY:INYCPY #36BNE ---      ;; *** ÁLL DONE SETTING COLORS SO GET;     ORIGINAL POINTERS BACK ***;PLASTA PTRPLASTA PTR+1;; *** ÔHIS ROUTINE ROTATES THE BORDER;     COLORS CLOCKWISE ***;; *** ÍOVE TOP BORDER TO THE RIGHT ***;START LDY #37LDA (PTR),YPHADEY;- LDA (PTR),YINYSTA (PTR),YDEY:DEYBPL -;; *** ÍOVE LEFT BORDER UP ***;LDA ROWSSTA VERTLDY #0- JSR DOWN40LDA (PTR),YJSR UP40STA (PTR),YJSR DOWN40DEC VERTBNE -;; *** ÍOVE BOTTOM BORDER LEFT ***;LDY #1- LDA (PTR),YDEYSTA (PTR),YINY:INYCPY #38BNE -;; *** ÍOVE RIGHT BORDER DOWN ***;LDA ROWSSTA VERTLDY #37- JSR UP40LDA (PTR),YJSR DOWN40STA (PTR),YJSR UP40DEC VERTBNE -JSR UP40PLASTA (PTR),YLDA <SCNLDY >SCNSTA PTRSTY PTR+1;; *** ÓLOW THINGS DOWN A BIT ***;JSR PAUSE;; *** ÓAVE POINTERS FOR REUSE ***;LDA PTR+1PHALDA PTRPHA;; *** ÇET ORIGINAL POINTERS ***;LDA <SCNLDY >SCNSTA PTRSTY PTR+1;; *** ÓET UP POINTERS FOR MOVING;     TEXT IN BORDER TO THE LEFT ***;CLCADC #41STA PTRBCC +INC PTR+1;; *** ÓET NUMBER OF SCREEN ROWS;     THAT WILL BE MOVED ***;+ LDX ROWSDEXSTX VERT+1;; *** ÍOVE FIRST SCREEN ROW LEFT ***;- LDY #0LDA (PTR),YPHA- INYLDA (PTR),YDEYSTA (PTR),YINYCPY #35BNE -PLASTA (PTR),Y;; ** ÍOVE DOWN ONE ROW  AND GO BACK;    AND MOVE IT ***;DEC VERT+1BMI +JSR DOWN40JMP --;; *** ÁGAIN, SLOW THINGS DOWN ***;+ JSR PAUSE;; *** ÓET UP TO MOVE CREDITS RIGHT ***;LDY #2- JSR DOWN40DEYBPL -;; *** ÓO MOVE CREDITS TO RIGHT ***;LDY #34LDA (PTR),YPHADEY- LDA (PTR),YINYSTA (PTR),YDEY:DEYBNE -INY:PLASTA (PTR),Y;; *** ÇET MOVE BORDER POINTERS BACK ***;PLASTA PTRPLASTA PTR+1;; *** ÃHECK FOR ANY KEYPRESS ***;JSR GETINBNE +JMP START ;CONTINUE ROUTINE IF NONE+ RTS ; RETURN TO CALLING PROGRAM;;; *** ÐAUSE ROUTINE ***;PAUSE LDY SPEED- JSR DELAYDEYBNE -RTS;; *** ÒOUTINE TO MOVE POINTER DOWN;     ONE ROW (40 SPACES);DOWN40 PHALDA PTRCLCADC #40STA PTRBCC +INC PTR+1+ PLARTS;; *** ÖARIABLE STORAGE AREA ***;VERT .BYTE 0,0;; *** ÒOUTINE TO MOVE POINTER UP;     ONE ROW (40 SPACES);UP40 PHALDA PTRSECSBC #40STA PTRBCS +DEC PTR+1+ PLARTS