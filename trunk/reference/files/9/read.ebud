;;        **   ML-ARRAY64.BUD   **;;        ** BY ÂOB K7 01/28/89 **;;        ** ÃONVERTED TO ÅÂÕÄ 64 **;             ÍAY 13, 1989 FOR;            USE IN SEQ-SORT.V1;;.ORG $033C ;DECIMAL 828.DIS;.DIS P;.MEM;;.OBJ "READ.ML";;** EQUATES **;FILEADD = $7000SETLFS = $FFBASETNAM = $FFBDOPEN = $FFC0CLRCHN = $FFCCCLOSE = $FFC3STATUS = $90CHKIN = $FFC6CHRIN = $FFCFFILES = $FDARYTAB = $2FPTR = $FBLOBYTE = $B0HIBYTE = $B1LENGTH = $9BFILECTR = 179ENDFLAG = 178CHROUT = $FFD2SHFLAG = 653LSTX = $C5SCNFLAG = 150;;** PROGRAM STARTS HERE **;LDX #8JSR CHKINLDA #0STA FILECTR ;ZERO # OF FILES FOUND;;;** SET ZERO PAGE POINTERS **;LDA <FILEADDSTA FILESLDA >FILEADDSTA FILES+1LDA ARYTABSTA PTRLDA ARYTAB+1STA PTR+1;;** SEARCH FOR THE 'B' IN BK$ **;LDY #0- LDA (PTR),YCMP "B"BEQ + ;FOUND IT. GO LOOK FOR K+$INYBNE -INC PTR+1BNE -BEQ END;;** LOOK FOR THE 'K$' IN BK$ **;+ INYBNE +INC PTR+1+ LDA (PTR),YCMP "K"+$80BEQ + ;FOUND IT.BNE -;;** SKIPS OFFSET, DIM BYTE, # OF            ELEMENTS BYTES, & F$(0) INFO**;+ LDX #9- INYBNE +INC PTR+1+ DEXBNE -;;** STORE ADDRESS TO FIRST ARRAY            DESCRIPTER IN PTR **;TYACLCADC PTRSTA PTRBCC +INC PTR+1;;** SET POINTER TO STORAGE AREA **;+ LDA FILESSTA LOBYTELDA FILES+1STA HIBYTE;;** GET TEXT **;LDY #0GETTXT JSR CHRINLDX STATUSSTX ENDFLAGBNE STRLTHLDX SCNFLAGBNE +JSR CHROUT+ CMP #13BEQ STRLTHSTA (LOBYTE),Y ;STORE FILENAMEINY            ;IN MEMORYBNE GETTXTINC HIBYTEBNE GETTXT;;** END OF PROGRAM ROUTINE. PUT             HERE SO IN RANGE OF BRANCHES.;END JSR CLRCHNLDA #8JSR CLOSERTS;;** STORE LENGTH OF FILENAME, AND           LO/HI-BYTE OF LOCATION **;STRLTH STY LENGTHTYACLCADC LOBYTESTA LOBYTEBCC +INC HIBYTE;;** COPY LENGTH & LOCATION TO THE           ARRAY DISCRIPTOR. **;+ LDY #0LDA LENGTHSTA (PTR),YINYLDA FILESSTA (PTR),YINYLDA FILES+1STA (PTR),YINY;;** SET POINTER TO START OF NEXT            DESCRIPTOR. **;TYACLCADC PTRSTA PTRBCC +INC PTR+1;;** SET POINTERS TO START OF NEXT           FILENAME STORAGE AREA. **;+ LDA LOBYTESTA FILESLDA HIBYTESTA FILES+1INC FILECTRLDX ENDFLAGBNE ENDLDY #0BEQ GETTXT